<!-- Header -->
<header class="<%= path === '/' ? '' : 'header-v4' %>">
	<!-- Header desktop -->
	<div class="container-menu-desktop">
		<!-- Topbar -->
		<div class="top-bar">
			<div class="content-topbar flex-sb-m h-full container">
				<div class="left-top-bar"></div>
				<div class="right-top-bar flex-w h-full">
					<% if (!isAuthenticated) { %>
					<a href="/login"
						class="<%= path === '/login' ? 'flex-c-m trans-04 p-lr-25 translate active-top' : 'flex-c-m trans-04 p-lr-25 translate' %>">
						Đăng nhập
					</a>

					<a href="/signup"
						class="<%= path === '/signup' ? 'flex-c-m trans-04 p-lr-25 translate active-top' : 'flex-c-m trans-04 p-lr-25 translate' %>">
						Đăng kí
					</a>
					<% } else { %> <% if(userr.role == "admin"){ %>
					<a href="/admin" class="flex-c-m trans-04 p-lr-25 translate">Admin</a>
					<% } %>
					<form action="/logout" method="POST">
						<button type="submit" class="flex-c-m trans-04 p-lr-25 translate form-in-a active-top">
							Đăng xuất
						</button>
					</form>

					<a href="/account" class="flex-c-m trans-04 p-lr-25 translate">
						<% if(userr){ %> <%= userr.email.substring(0,
            userr.email.lastIndexOf("@")) %> <% } %>
					</a>
					<% } %>
				</div>
			</div>
		</div>

		<div class="wrap-menu-desktop">
			<nav class="limiter-menu-desktop container">
				<!-- Logo desktop -->
				<a href="/" class="logo">
					<img src="/images/logo_cam_tron.png" alt="logo" height="auto" width="50px" />
				</a>
				<!-- Menu desktop -->
				<div class="menu-desktop">
					<ul class="main-menu">
						<li class="<%= path === '/' ? 'active-menu' : '' %>">
							<a class="translate" href="/">Muzzy</a>
						</li>

						<li class="<%= path === '/coffees' ? 'active-menu' : '' %>">
							<a href="/coffees" class="translate">Acoustic Coffee</a>
						</li>

						<li class="<%= path === '/teachers' ? 'active-menu' : '' %>">
							<a href="/teachers" class="translate">Người hướng dẫn</a>
						</li>

						<% if (isAuthenticated) { %>
						<li class="<%= path === '/cart' ? 'active-menu' : '' %>">
							<a href="/cart" class="translate">Giỏ hàng</a>
						</li>
						<% } %>

						<li class="<%= path === '/blog' ? 'active-menu' : '' %>">
							<a href="/blog" class="translate">Tin tức</a>
						</li>

						<li class="<%= path === '/about' ? 'active-menu' : '' %>">
							<a href="/about" class="translate">Về chúng tôi</a>
						</li>

						<!-- <li class="<%= path === '/contact' ? 'active-menu' : '' %>">
							<a href="/contact" class="translate">Contact</a>
						</li> -->
					</ul>
				</div>

				<!-- Icon header -->
				<div class="wrap-icon-header flex-w flex-r-m">
					<!-- <div
            class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-modal-search"
          >
            <i class="zmdi zmdi-search" style="color: #555;"></i>
          </div> -->

					<% if (isAuthenticated) { %>
					<!-- <div
            id="shopCart"
            class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti js-show-cart"
            data-notify="0"
          >
            <i class="zmdi zmdi-shopping-cart"></i>
          </div> -->

					<% } %>
				</div>
			</nav>
		</div>
	</div>

	<!-- Header Mobile -->
	<div class="wrap-header-mobile">
		<!-- Logo moblie -->
		<div class="logo-mobile">
			<a href="/">
				<img src="/images/logo_cam_tron.png" alt="logo" height="auto" width="32px" />
			</a>
		</div>

		<!-- Icon header -->
		<!-- <div class="wrap-icon-header flex-w flex-r-m m-r-15">
      <div
        class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 js-show-modal-search"
      >
        <i class="zmdi zmdi-search"></i>
      </div>

      <div
        class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart"
        data-notify="2"
      >
        <i class="zmdi zmdi-shopping-cart"></i>
      </div>

      <a
        href="#"
        class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti"
        data-notify="0"
      >
        <i class="zmdi zmdi-favorite-outline"></i>
      </a>
    </div> -->

		<!-- Button show menu -->
		<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
			<span class="hamburger-box">
				<span class="hamburger-inner"></span>
			</span>
		</div>
	</div>

	<!-- Menu Mobile -->
	<div class="menu-mobile">
		<ul class="topbar-mobile">
			<li>
				<div class="right-top-bar flex-w h-full">
					<% if (!isAuthenticated) { %>
					<a href="/login"
						class="<%= path === '/login' ? 'flex-c-m trans-04 p-lr-10 translate active-top' : 'flex-c-m trans-04 p-lr-10 translate' %>">
						Đăng nhập
					</a>
					<a href="/signup"
						class="<%= path === '/signup' ? 'flex-c-m trans-04 p-lr-10 translate active-top' : 'flex-c-m trans-04 p-lr-10 translate' %>">
						Đăng kí
					</a>
					<% } else { %>

					<form action="/logout" method="POST">
						<button type="submit" class="flex-c-m trans-04 p-lr-10 translate form-in-a active-top">
							Đăng xuất
						</button>
					</form>

					<a href="/account" class="flex-c-m trans-04 p-lr-10 translate">
						Tài khoản
					</a>

					<% } %>
				</div>
			</li>
		</ul>

		<ul class="main-menu-m">
			<li class="<%= path === '/' ? 'active-menu' : '' %>">
				<a class="translate" href="/">Muzzy</a>
			</li>

			<li class="<%= path === '/coffees' ? 'active-menu' : '' %>">
				<a href="/coffees" class="translate">Acoustic Coffee</a>
			</li>

			<% if (isAuthenticated) { %>
			<li class="<%= path === '/cart' ? 'active-menu' : '' %>">
				<a href="/cart" class="translate">Giỏ hàng</a>
			</li>
			<% } %>
			<li class="<%= path === '/teachers' ? 'active-menu' : '' %>">
				<a href="/teachers" class="translate">Người hướng dẫn</a>
			</li>

			<li class="<%= path === '/about' ? 'active-menu' : '' %>">
				<a href="/blog" class="translate">Tin tức</a>
			</li>

			<li class="<%= path === '/contact' ? 'active-menu' : '' %>">
				<a href="/about" class="translate">Về chúng tôi</a>
			</li>
		</ul>
	</div>

	<!-- Modal Search -->
	<!-- <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
		<div class="container-search-header">
			<button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
				<img src="/images/icons/icon-close2.png" alt="CLOSE" />
			</button>

			<form class="wrap-search-header flex-w p-l-15" method="POST" action="/search">
				<button type="submit" class="flex-c-m trans-04">
					<i class="zmdi zmdi-search"></i>
				</button>

				<input class="plh3" type="text" name="search" id="search" placeholder="Tìm kiếm" />
			</form>
		</div>
	</div> -->
</header>
<script>
	$(document).ready(function () {
		$.ajax({
			url: "/api/cart",
			type: "GET",
			dataType: "json"
		}).done(function (res) {
			const sumPrice = res.sumPrice;
			const products = res.products;
			console.log(products.length);
			$("#shopCart").attr("data-notify", products.length);
			$("#sumPrice").html(sumPrice);
			$("#cart-product-list").html(
				TemplateCartRSide.createProductList(products)
			);
		});
	});

	const TemplateCartRSide = (function () {
		const createProductList = function (products) {
			let rs = "";
			for (let i = 0; i < products.length; i++) {
				const product = products[i];
				const productId = product.productId;
				const quantity = product.quantity;
				let template =
					"" +
					'   <li class="header-cart-item flex-w flex-t m-b-12">  ' +
					'   	<div class="header-cart-item-img">  ' +
					'   		<img src="' +
					productId.imageUrl +
					'" alt="IMG">  ' +
					"   	</div>  " +
					"     " +
					'   	<div class="header-cart-item-txt p-t-8">  ' +
					'   		<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">  ' +
					productId.name +
					"   		</a>  " +
					'   		<span class="header-cart-item-info">  ' +
					quantity +
					" x $" +
					productId.price +
					"   		</span>  " +
					"   	</div>  " +
					"  </li>  ";
				rs += template;
			}
			return rs;
		};
		return {
			createProductList: createProductList
		};
	})();
</script>